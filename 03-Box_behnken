from pyDOE3 import bbdesign
import numpy as np
import pandas as pd

range_protein = (50, 150)
range_succrose = (200,300)
range_buffer = (50, 150)

# Creating a design we can use
bbdesign = bbdesign(3, center=1)
# Adding meaningful labels
bb_df = pd.DataFrame(bbdesign, columns=['Protein [ÂµM]', 'Succrose [mM]', 'Buffer [mM]'])

def scale_design(bb_df, factor_ranges):
    # Working with a copy to keep the original intact
    scaled_design = bb_df.copy()

    # Processing each factor
    for i, (low, high) in enumerate(factor_ranges):
        # Finding the middle point and the spread
        center = (high + low) / 2
        range_val = high - low

        # Converting: -1 becomes low, 0 becomes center, 1 becomes high
        scaled_design.iloc[:, i] = center + bb_df.iloc[:, i] * range_val / 2

    return scaled_design
# Setting our actual experimental ranges
factor_ranges = [
    (range_protein),   
    (range_succrose),      
    (range_buffer),
]

# Transforming to real values
scaled_df = scale_design(bb_df, factor_ranges)
print("Ready for the lab:")
print(scaled_df)







#pd.ExcelWriter("c:/Users/GAURIJU1/OneDrive - Novartis Pharma AG/Documents/DOE.xlsx" )
